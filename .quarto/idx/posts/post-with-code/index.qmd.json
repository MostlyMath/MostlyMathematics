{"title":"The Birkhoff's Ergodic Theorem","markdown":{"yaml":{"title":"The Birkhoff's Ergodic Theorem","date":"2025-09-10","categories":["Analysis","Dynamics"],"bibliography":"../../references.bib","nocite":"@walters1982\n@silva2008\n@assani2003wiener\n"},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n\nThe ergodic theorem was proved in 1931, first by John von Neumann in the case of ${\\mathcal{L}}^2$ convergence and then by Birkhoff in the much stronger case of pointwise convergence which solved the most fundamental question in statistical mechanics: when does the time average converge to the space average? Before getting into this let us think about what [Poincaré Recurrence](\\posts\\my-first-post) gave us:\n\n> Let $T : \\mathcal{X} \\to \\mathcal{X}$ be a measure-preserving transformation of a probability space $(\\mathcal{X}, \\beta, \\mu)$. Let $\\mathcal{E} \\in \\beta$ with $m(\\mathcal{E}) > 0$. Then almost all points of $\\mathcal{E}$ return infinitely often to $\\mathcal{E}$ under positive iteration by $T$ (i.e., there exists $\\mathcal{F} \\subseteq \\mathcal{E}$ with $m(\\mathcal{F}) = m(\\mathcal{E})$ such that for each $x \\in \\mathcal{F}$ there is a sequence $n_1 < n_2 < n_3 < \\cdots$ of natural numbers with $T^{n_i}(x) \\in \\mathcal{F}$ for each $i$).\n\nSo, if we have a measure preserving system, then we can take a measurable set $\\mathcal{E}$ with a point $x \\in \\mathcal{E}$ which returns infinitely often to $\\mathcal{E}$. Poincaré Recurrence guarantees the existence of such a point. What we want to find now is in some sense: the frequency of the occurence of the points of the orbit of $x$ in $\\mathcal{E}$. \n\nLet $\\mathcal{O}(x) = \\{ x, T(x), T^2(x), \\dots \\}$ be the orbit of $x \\in \\mathcal{E}$. Let $\\mathcal{O}_N(x) := \\{ x, \\dots , T^{N-1}(x) \\}$\n\nThe frequency of the number of points of $\\mathcal{O}_N(x)$ that are also in $E$ can be represented as follows:\n$$ \\frac{1}{N} \\sum_{i=0}^{N-1} X_E(T^i(x)), $$\nwhere $X_E$ is the characteristic function of $E$. Now what would happen if $N$ keeps increasing? Consider the following limit:\n$$ \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{i=0}^{N-1} X_E(T^i(x)) $$\nSome questions we may have are: Will such a limit exist in the first place? Under what condidtions can such a limit exist? Incase it does, what can it possibly converge to? \n\nLet us genralize our problem to an arbitary measurable or integrable function $f$ instead of the characteristic function and call the limit the time average. So now we want to know what could possibly happen to $$ \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{i=0}^{N-1} f(T^i(x)) $$\n\nBoltzmann (in a very physics pov perhaps) hypothesized that the time average converges to the space average which is $\\int f d\\mu$. This is not quite true always which leads us to the Birkhoff's ergodic theorem which says that in the case of an ergodic system, the time average converges to the space average. Let us first understand what an ergodic transformation is.\n\n### Ergodicity\n\nErgodicity formalizes the idea of when a dynamical system cannot be broken down into smaller invariant pieces with positive measure. Let us first see what an invariant set is:\n\n> Let $T: \\mathcal{X} \\rightarrow \\mathcal{X}$ be a transformation. A subset $\\mathcal{B}$ of $\\mathcal{X}$ is **invariant** under $T$ if $T^{-1}(\\mathcal{B})=\\mathcal{B}$.\n\nNote that $T$ need not be invertible here. $T^{-1}(\\mathcal{B})$ just refers to all the points in $\\mathcal{X}$ that $T$ takes to $\\mathcal{B}$. Now we can define what an ergodic transformation is.\n\n> A measure preserving transformation T on a probability space is **ergodic** if for every $T$-invariant set $\\mathcal{B}$ in $\\beta$, either $\\mu(\\mathcal{B})=0$ or $\\mu(\\mathcal{B})=1$. \n\nIn other words, the system is measure-theoretically indecomposable i.e: any invariant set is either negligible or occupies the whole space.\n\n**Example:** Consider a rational rotation on the following set $\\mathcal{A}$ in $\\mathbb{R}/\\mathbb{Z}$. \n$$\n\\mathcal{A} = \\bigcup_{i=0}^{q-1} \\left[ \\frac{i}{q},\\frac{i}{q}+\\frac{1}{2q}\\right].\n$$\nThis set is invariant under $R_\\alpha$ as it sends each interval in $\\mathcal{A}$ into another one in $\\mathcal{A}$ itself but the measure of this set lies between $0$ and $1$ making it non-ergodic. Turns out, irrational rotations are ergodic which we will probably look into in another post (along with more consequences of ergodicity).\n\nWe are now ready to state the Birkhoff's ergodic theorem. Note that we restrict ourselves to a probability space since any finite measure space can be normalized accordingly.\n\n### The Birkhoff's Ergodic Theorem\n\n> Let $(\\mathcal{X},\\beta,\\mu)$ be a probability space and let $T$ be an ergodic transformation on $(\\mathcal{X},\\beta,\\mu)$. If $f: \\mathcal{X} \\to \\mathbb{R}$ is an integrable function, then for $\\mu$-a.e $x \\in \\mathcal{X}$\n> $$\n    \\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{i=0}^{n-1} f(T^i(x)) = \\int f d\\mu \n  $$\n\n### Can ergodicity be relaxed?\n\nNow, what happens if we do not have an ergodic system? Turns out, in the case of measure-preserving systems, the time average does converge, not to the space average, but to a $T$-invariant function as stated below and we can also very easily find the integral of this limit function.\n\n> Let $(\\mathcal{X},\\beta,\\mu)$ be a probability space and let $T$ be a measure-preserving transformation on $(\\mathcal{X},\\beta,\\mu)$. If $f: \\mathcal{X} \\to \\mathbb{R}$ is an integrable function, then  \n\n> 1. $\\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{i=0}^{n-1} f(T^i(x))$ exists for a.e $x \\in \\mathcal{X}$. Denote this limit by $\\bar{f}(x)$.  \n> 2. $\\bar{f}(Tx) = \\bar{f}(x)$ a.e.  \n> 3. For any measurable set $\\mathcal{A}$ that is $T$-invariant,  \n>    \\begin{equation*}\n        \\int_{\\mathcal{A}} f d\\mu = \\int_{\\mathcal{A}} \\bar{f} d\\mu.\n    \\end{equation*}\n\nThe proof is quite lengthy and I am skipping it here. One can refer to [@silva2008] for a beginner-friendly proof. One can also refer to [@assani2003wiener] which has 3 very interesting proofs (one using the maximal inequality, one using a combinatorial argument and the last using a variational inequality) which are a little advanced.\n\n### References\n\n","srcMarkdownNoYaml":"\n\n### Introduction\n\nThe ergodic theorem was proved in 1931, first by John von Neumann in the case of ${\\mathcal{L}}^2$ convergence and then by Birkhoff in the much stronger case of pointwise convergence which solved the most fundamental question in statistical mechanics: when does the time average converge to the space average? Before getting into this let us think about what [Poincaré Recurrence](\\posts\\my-first-post) gave us:\n\n> Let $T : \\mathcal{X} \\to \\mathcal{X}$ be a measure-preserving transformation of a probability space $(\\mathcal{X}, \\beta, \\mu)$. Let $\\mathcal{E} \\in \\beta$ with $m(\\mathcal{E}) > 0$. Then almost all points of $\\mathcal{E}$ return infinitely often to $\\mathcal{E}$ under positive iteration by $T$ (i.e., there exists $\\mathcal{F} \\subseteq \\mathcal{E}$ with $m(\\mathcal{F}) = m(\\mathcal{E})$ such that for each $x \\in \\mathcal{F}$ there is a sequence $n_1 < n_2 < n_3 < \\cdots$ of natural numbers with $T^{n_i}(x) \\in \\mathcal{F}$ for each $i$).\n\nSo, if we have a measure preserving system, then we can take a measurable set $\\mathcal{E}$ with a point $x \\in \\mathcal{E}$ which returns infinitely often to $\\mathcal{E}$. Poincaré Recurrence guarantees the existence of such a point. What we want to find now is in some sense: the frequency of the occurence of the points of the orbit of $x$ in $\\mathcal{E}$. \n\nLet $\\mathcal{O}(x) = \\{ x, T(x), T^2(x), \\dots \\}$ be the orbit of $x \\in \\mathcal{E}$. Let $\\mathcal{O}_N(x) := \\{ x, \\dots , T^{N-1}(x) \\}$\n\nThe frequency of the number of points of $\\mathcal{O}_N(x)$ that are also in $E$ can be represented as follows:\n$$ \\frac{1}{N} \\sum_{i=0}^{N-1} X_E(T^i(x)), $$\nwhere $X_E$ is the characteristic function of $E$. Now what would happen if $N$ keeps increasing? Consider the following limit:\n$$ \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{i=0}^{N-1} X_E(T^i(x)) $$\nSome questions we may have are: Will such a limit exist in the first place? Under what condidtions can such a limit exist? Incase it does, what can it possibly converge to? \n\nLet us genralize our problem to an arbitary measurable or integrable function $f$ instead of the characteristic function and call the limit the time average. So now we want to know what could possibly happen to $$ \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{i=0}^{N-1} f(T^i(x)) $$\n\nBoltzmann (in a very physics pov perhaps) hypothesized that the time average converges to the space average which is $\\int f d\\mu$. This is not quite true always which leads us to the Birkhoff's ergodic theorem which says that in the case of an ergodic system, the time average converges to the space average. Let us first understand what an ergodic transformation is.\n\n### Ergodicity\n\nErgodicity formalizes the idea of when a dynamical system cannot be broken down into smaller invariant pieces with positive measure. Let us first see what an invariant set is:\n\n> Let $T: \\mathcal{X} \\rightarrow \\mathcal{X}$ be a transformation. A subset $\\mathcal{B}$ of $\\mathcal{X}$ is **invariant** under $T$ if $T^{-1}(\\mathcal{B})=\\mathcal{B}$.\n\nNote that $T$ need not be invertible here. $T^{-1}(\\mathcal{B})$ just refers to all the points in $\\mathcal{X}$ that $T$ takes to $\\mathcal{B}$. Now we can define what an ergodic transformation is.\n\n> A measure preserving transformation T on a probability space is **ergodic** if for every $T$-invariant set $\\mathcal{B}$ in $\\beta$, either $\\mu(\\mathcal{B})=0$ or $\\mu(\\mathcal{B})=1$. \n\nIn other words, the system is measure-theoretically indecomposable i.e: any invariant set is either negligible or occupies the whole space.\n\n**Example:** Consider a rational rotation on the following set $\\mathcal{A}$ in $\\mathbb{R}/\\mathbb{Z}$. \n$$\n\\mathcal{A} = \\bigcup_{i=0}^{q-1} \\left[ \\frac{i}{q},\\frac{i}{q}+\\frac{1}{2q}\\right].\n$$\nThis set is invariant under $R_\\alpha$ as it sends each interval in $\\mathcal{A}$ into another one in $\\mathcal{A}$ itself but the measure of this set lies between $0$ and $1$ making it non-ergodic. Turns out, irrational rotations are ergodic which we will probably look into in another post (along with more consequences of ergodicity).\n\nWe are now ready to state the Birkhoff's ergodic theorem. Note that we restrict ourselves to a probability space since any finite measure space can be normalized accordingly.\n\n### The Birkhoff's Ergodic Theorem\n\n> Let $(\\mathcal{X},\\beta,\\mu)$ be a probability space and let $T$ be an ergodic transformation on $(\\mathcal{X},\\beta,\\mu)$. If $f: \\mathcal{X} \\to \\mathbb{R}$ is an integrable function, then for $\\mu$-a.e $x \\in \\mathcal{X}$\n> $$\n    \\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{i=0}^{n-1} f(T^i(x)) = \\int f d\\mu \n  $$\n\n### Can ergodicity be relaxed?\n\nNow, what happens if we do not have an ergodic system? Turns out, in the case of measure-preserving systems, the time average does converge, not to the space average, but to a $T$-invariant function as stated below and we can also very easily find the integral of this limit function.\n\n> Let $(\\mathcal{X},\\beta,\\mu)$ be a probability space and let $T$ be a measure-preserving transformation on $(\\mathcal{X},\\beta,\\mu)$. If $f: \\mathcal{X} \\to \\mathbb{R}$ is an integrable function, then  \n\n> 1. $\\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{i=0}^{n-1} f(T^i(x))$ exists for a.e $x \\in \\mathcal{X}$. Denote this limit by $\\bar{f}(x)$.  \n> 2. $\\bar{f}(Tx) = \\bar{f}(x)$ a.e.  \n> 3. For any measurable set $\\mathcal{A}$ that is $T$-invariant,  \n>    \\begin{equation*}\n        \\int_{\\mathcal{A}} f d\\mu = \\int_{\\mathcal{A}} \\bar{f} d\\mu.\n    \\end{equation*}\n\nThe proof is quite lengthy and I am skipping it here. One can refer to [@silva2008] for a beginner-friendly proof. One can also refer to [@assani2003wiener] which has 3 very interesting proofs (one using the maximal inequality, one using a combinatorial argument and the last using a variational inequality) which are a little advanced.\n\n### References\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.24","theme":"lux","title-block-banner":true,"title":"The Birkhoff's Ergodic Theorem","date":"2025-09-10","categories":["Analysis","Dynamics"],"bibliography":["../../references.bib"],"nocite":"@walters1982\n@silva2008\n@assani2003wiener\n"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}